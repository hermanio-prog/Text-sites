<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Exame de Condução - Macau</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f0f7ff;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 20px 0;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            margin-bottom: 30px;
        }
        
        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .game-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        .main-menu {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .menu-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            border-left: 5px solid #2a5298;
        }
        
        .menu-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }
        
        .menu-card i {
            font-size: 3rem;
            color: #2a5298;
            margin-bottom: 15px;
        }
        
        .menu-card h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: #1e3c72;
        }
        
        .menu-card p {
            color: #666;
            margin-bottom: 15px;
        }
        
        .status-bar {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .progress-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .progress-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: conic-gradient(#4CAF50 0% 75%, #eee 75% 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .progress-circle::before {
            content: '';
            position: absolute;
            width: 70px;
            height: 70px;
            background: white;
            border-radius: 50%;
        }
        
        .progress-circle span {
            position: relative;
            font-weight: bold;
            font-size: 1.2rem;
            color: #1e3c72;
        }
        
        .game-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            min-height: 500px;
            display: none;
        }
        
        .game-content.active {
            display: block;
        }
        
        .quiz-question {
            font-size: 1.3rem;
            margin-bottom: 25px;
            color: #1e3c72;
            font-weight: 600;
            line-height: 1.5;
        }
        
        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .quiz-option {
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: flex-start;
        }
        
        .quiz-option:hover {
            background-color: #f5f9ff;
        }
        
        .quiz-option.selected {
            border-color: #2a5298;
            background-color: #e8efff;
        }
        
        .quiz-option.correct {
            border-color: #4CAF50;
            background-color: #e8f5e9;
        }
        
        .quiz-option.wrong {
            border-color: #f44336;
            background-color: #ffebee;
        }
        
        .option-letter {
            display: inline-block;
            width: 30px;
            height: 30px;
            background-color: #2a5298;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            margin-right: 15px;
            flex-shrink: 0;
            font-weight: bold;
        }
        
        .quiz-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: #2a5298;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #1e3c72;
        }
        
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #5a6268;
        }
        
        .btn-success {
            background-color: #4CAF50;
            color: white;
        }
        
        .btn-success:hover {
            background-color: #388e3c;
        }
        
        .result-message {
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 1.2rem;
            margin: 20px 0;
            display: none;
        }
        
        .result-message.success {
            background-color: #e8f5e9;
            color: #2e7d32;
            border: 2px solid #4CAF50;
            display: block;
        }
        
        .result-message.error {
            background-color: #ffebee;
            color: #c62828;
            border: 2px solid #f44336;
            display: block;
        }
        
        .result-message.info {
            background-color: #e3f2fd;
            color: #1565c0;
            border: 2px solid #2196f3;
            display: block;
        }
        
        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .back-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: #2a5298;
            cursor: pointer;
        }
        
        .game-stats {
            display: flex;
            gap: 20px;
            color: #666;
        }
        
        .category-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .category-btn {
            padding: 8px 16px;
            background-color: #e8efff;
            border: 2px solid #2a5298;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .category-btn.active {
            background-color: #2a5298;
            color: white;
        }
        
        .category-btn:hover {
            background-color: #d0dbf9;
        }
        
        .exam-info {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #2a5298;
        }
        
        .exam-info h3 {
            color: #1e3c72;
            margin-bottom: 10px;
        }
        
        .exam-info p {
            margin-bottom: 5px;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #666;
            font-size: 0.9rem;
        }
        
        .question-counter {
            background-color: #e8efff;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            color: #1e3c72;
        }
        
        .score-display {
            background-color: #e8f5e9;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            color: #2e7d32;
        }
        
        .timer {
            background-color: #fff3cd;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            color: #856404;
        }
        
        @media (max-width: 768px) {
            .main-menu {
                grid-template-columns: 1fr;
            }
            
            .status-bar {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }
            
            .game-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .game-stats {
                flex-direction: column;
                gap: 10px;
            }
            
            .quiz-controls {
                flex-direction: column;
                gap: 10px;
            }
            
            .quiz-controls .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1><i class="fas fa-car"></i> Simulador de Exame de Condução - Macau</h1>
            <p>Prepare-se para o exame teórico com todas as 150 questões oficiais do Grupo C - Regras de Trânsito</p>
        </div>
    </header>
    
    <div class="container">
        <div class="status-bar">
            <div>
                <h2>Bem-vindo ao Simulador de Exame</h2>
                <p>Baseado no Fascículo III – Regras de Trânsito da Direcção dos Serviços para os Assuntos de Tráfego</p>
            </div>
            
            <div class="progress-section">
                <div class="progress-circle">
                    <span id="progressPercentage">0%</span>
                </div>
                <div>
                    <h3>Progresso Geral</h3>
                    <p id="progressText">0 de 150 questões estudadas</p>
                </div>
            </div>
        </div>
        
        <div class="game-container">
            <div class="main-menu" id="mainMenu">
                <div class="menu-card" data-game="quiz">
                    <i class="fas fa-question-circle"></i>
                    <h3>Quiz por Categorias</h3>
                    <p>Estude as questões organizadas por temas para melhor aprendizagem</p>
                    <span class="btn btn-primary">Iniciar Estudo</span>
                </div>
                
                <div class="menu-card" data-game="exam">
                    <i class="fas fa-file-alt"></i>
                    <h3>Simulado Completo</h3>
                    <p>Faça um simulado com 30 questões como no exame real</p>
                    <span class="btn btn-primary">Fazer Simulado</span>
                </div>
                
                <div class="menu-card" data-game="review">
                    <i class="fas fa-book"></i>
                    <h3>Revisão de Erros</h3>
                    <p>Revise as questões que errou para melhorar seu desempenho</p>
                    <span class="btn btn-primary">Revisar Erros</span>
                </div>
                
                <div class="menu-card" data-game="stats">
                    <i class="fas fa-chart-bar"></i>
                    <h3>Estatísticas</h3>
                    <p>Veja seu progresso e desempenho em cada categoria</p>
                    <span class="btn btn-primary">Ver Estatísticas</span>
                </div>
            </div>
            
            <!-- Quiz por Categorias -->
            <div class="game-content" id="quizGame">
                <div class="game-header">
                    <button class="back-btn" id="backFromQuiz"><i class="fas fa-arrow-left"></i> Voltar</button>
                    <div>
                        <h2>Quiz por Categorias</h2>
                        <div class="game-stats">
                            <span class="score-display"><i class="fas fa-check-circle"></i> Acertos: <span id="quizScore">0</span></span>
                            <span class="question-counter"><i class="fas fa-question-circle"></i> Questão: <span id="quizQuestionNum">1</span>/<span id="quizTotalQuestions">0</span></span>
                        </div>
                    </div>
                </div>
                
                <div class="category-selector" id="categorySelector">
                    <!-- Categorias serão carregadas via JavaScript -->
                </div>
                
                <div class="quiz-question" id="quizQuestion">
                    Carregando questão...
                </div>
                
                <div class="quiz-options" id="quizOptions">
                    <!-- As opções serão carregadas via JavaScript -->
                </div>
                
                <div class="result-message" id="quizResult"></div>
                
                <div class="quiz-controls">
                    <button class="btn btn-secondary" id="quizHint">Explicação</button>
                    <button class="btn btn-primary" id="quizSubmit" disabled>Confirmar Resposta</button>
                    <button class="btn btn-success" id="quizNext" style="display: none;">Próxima Questão</button>
                </div>
            </div>
            
            <!-- Simulado Completo -->
            <div class="game-content" id="examGame">
                <div class="game-header">
                    <button class="back-btn" id="backFromExam"><i class="fas fa-arrow-left"></i> Voltar</button>
                    <div>
                        <h2>Simulado de Exame</h2>
                        <div class="game-stats">
                            <span class="score-display"><i class="fas fa-check-circle"></i> Acertos: <span id="examScore">0</span>/30</span>
                            <span class="question-counter"><i class="fas fa-question-circle"></i> Questão: <span id="examQuestionNum">1</span>/30</span>
                            <span class="timer"><i class="fas fa-clock"></i> Tempo: <span id="examTimer">30:00</span></span>
                        </div>
                    </div>
                </div>
                
                <div class="exam-info">
                    <h3><i class="fas fa-info-circle"></i> Informações do Exame</h3>
                    <p><strong>Formato:</strong> 30 questões de múltipla escolha (como no exame real)</p>
                    <p><strong>Aprovação:</strong> Máximo de 8 erros no total e máximo de 2 erros por grupo</p>
                    <p><strong>Tempo:</strong> 30 minutos para completar o simulado</p>
                </div>
                
                <div class="quiz-question" id="examQuestion">
                    Carregando questão...
                </div>
                
                <div class="quiz-options" id="examOptions">
                    <!-- As opções serão carregadas via JavaScript -->
                </div>
                
                <div class="result-message" id="examResult"></div>
                
                <div class="quiz-controls">
                    <button class="btn btn-primary" id="examSubmit" disabled>Confirmar Resposta</button>
                    <button class="btn btn-success" id="examNext" style="display: none;">Próxima Questão</button>
                    <button class="btn btn-secondary" id="examFinish" style="display: none;">Ver Resultado</button>
                </div>
            </div>
            
            <!-- Revisão de Erros -->
            <div class="game-content" id="reviewGame">
                <div class="game-header">
                    <button class="back-btn" id="backFromReview"><i class="fas fa-arrow-left"></i> Voltar</button>
                    <div>
                        <h2>Revisão de Erros</h2>
                        <div class="game-stats">
                            <span class="score-display"><i class="fas fa-times-circle"></i> Erros para revisar: <span id="reviewCount">0</span></span>
                        </div>
                    </div>
                </div>
                
                <div id="reviewContent">
                    <!-- Conteúdo será carregado via JavaScript -->
                </div>
            </div>
            
            <!-- Estatísticas -->
            <div class="game-content" id="statsGame">
                <div class="game-header">
                    <button class="back-btn" id="backFromStats"><i class="fas fa-arrow-left"></i> Voltar</button>
                    <div>
                        <h2>Estatísticas e Progresso</h2>
                    </div>
                </div>
                
                <div id="statsContent">
                    <!-- Estatísticas serão carregadas via JavaScript -->
                </div>
            </div>
        </div>
    </div>
    
    <footer>
        <div class="container">
            <p>Simulador de Exame de Condução &copy; 2023 - Baseado no Fascículo III – Regras de Trânsito da Direcção dos Serviços para os Assuntos de Tráfego de Macau</p>
            <p>Este simulador é educativo e não substitui a formação oficial de uma escola de condução.</p>
        </div>
    </footer>

    <script>
        // DADOS COMPLETOS DAS 150 QUESTÕES DO GRUPO C
        const allQuestions = [
            // Questões 1-20: Definições Gerais
            {
                id: 1,
                question: "O que entende por via pública?",
                options: [
                    "Via de comunicação terrestre aberta ao trânsito público.",
                    "Via de comunicação aberta ao trânsito de peões.",
                    "Parte da via pública especialmente destinada ao trânsito de veículos.",
                    "Via de comunicação destinada especialmente ao trânsito de veículos de transporte de passageiros públicos."
                ],
                correct: 0,
                category: "Definições Gerais",
                explanation: "Via pública é qualquer via de comunicação terrestre aberta ao trânsito público, conforme definido na legislação."
            },
            {
                id: 2,
                question: "O que entende por via rápida?",
                options: [
                    "Via pública sem restrição de velocidade máxima.",
                    "Via pública sem restrição de velocidade.",
                    "Via pública na qual a velocidade máxima permitida excede os limites máximos genéricos previstos.",
                    "Via pública apenas com restrição de velocidade máxima."
                ],
                correct: 2,
                category: "Definições Gerais",
                explanation: "Via rápida é uma via pública onde a velocidade máxima permitida excede os limites máximos genéricos previstos na lei."
            },
            {
                id: 3,
                question: "O que entende por auto-estrada?",
                options: [
                    "Via pública sem restrição de velocidade máxima.",
                    "Via pública destinada a trânsito rápido, com separação física das faixas de rodagem, com acessos condicionados, e sinalizada como tal.",
                    "Via pública destinada a trânsito rápido, sem separação física das faixas de rodagem, com acessos condicionados, e sinalizada como tal.",
                    "Via pública em que o veículo pode circular a qualquer velocidade."
                ],
                correct: 1,
                category: "Definições Gerais",
                explanation: "Auto-estrada é uma via pública especialmente destinada a trânsito rápido, com separação física das faixas de rodagem, acessos condicionados e devidamente sinalizada."
            },
            {
                id: 4,
                question: "O que entende por berma?",
                options: [
                    "Superfície da via pública que ladeia a faixa de rodagem.",
                    "Superfície da via pública destinada especialmente ao trânsito de peões e que ladeia a faixa de rodagem.",
                    "Superfície da via pública destinada especialmente ao trânsito de veículos e que ladeia a faixa de rodagem.",
                    "Superfície da via pública não especialmente destinada ao trânsito de veículos e que ladeia a faixa de rodagem."
                ],
                correct: 3,
                category: "Definições Gerais",
                explanation: "Berma é a superfície da via pública não especialmente destinada ao trânsito de veículos e que ladeia a faixa de rodagem."
            },
            {
                id: 5,
                question: "O que entende por caminho?",
                options: [
                    "Via especialmente destinada ao trânsito local em zonas não urbanizadas.",
                    "Via pública destinada especialmente ao trânsito de peões e de bicicletas.",
                    "Via pública sem intersecção.",
                    "Via especialmente destinada ao trânsito local em zonas urbanizadas."
                ],
                correct: 0,
                category: "Definições Gerais",
                explanation: "Caminho é uma via especialmente destinada ao trânsito local em zonas não urbanizadas."
            },
            {
                id: 6,
                question: "O que entende por corredor de circulação?",
                options: [
                    "Via de trânsito reservada a camiões.",
                    "Via de trânsito reservada a ciclomotores e motociclos.",
                    "Via de trânsito reservada a veículos de certa espécie ou afectos a determinados transportes.",
                    "Via de trânsito reservada a veículos que a necessitem."
                ],
                correct: 2,
                category: "Definições Gerais",
                explanation: "Corredor de circulação é uma via de trânsito reservada a veículos de certa espécie ou afectos a determinados transportes."
            },
            {
                id: 7,
                question: "O que entende por faixa de rodagem?",
                options: [
                    "Parte da via pública especialmente destinada ao trânsito de veículos.",
                    "Parte da via pública especialmente destinada ao trânsito de automóveis.",
                    "Parte da via pública especialmente destinada ao trânsito de ciclomotores e motociclos.",
                    "Parte da via pública especialmente destinada ao trânsito de veículos de transporte de passageiros."
                ],
                correct: 0,
                category: "Definições Gerais",
                explanation: "Faixa de rodagem é a parte da via pública especialmente destinada ao trânsito de veículos."
            },
            {
                id: 8,
                question: "O que entende por eixo da faixa de rodagem?",
                options: [
                    "Linha longitudinal, demarcada ou não, que divide uma faixa de rodagem em duas partes, cada uma afecta a um sentido de trânsito.",
                    "Linha latitudinal, demarcada ou não, que divide uma faixa de rodagem em duas partes.",
                    "Linha longitudinal, demarcada obrigatoriamente com sinais, que divide uma faixa de rodagem em duas partes.",
                    "Linha longitudinal, demarcada, que divide uma faixa de rodagem em duas ou três partes."
                ],
                correct: 0,
                category: "Definições Gerais",
                explanation: "Eixo da faixa de rodagem é a linha longitudinal, demarcada ou não, que divide uma faixa de rodagem em duas partes, cada uma afecta a um sentido de trânsito."
            },
            {
                id: 9,
                question: "O que entende por entroncamento?",
                options: [
                    "Zona de junção ou bifurcação de vias públicas.",
                    "Zona de intersecção de vias públicas ao mesmo nível.",
                    "Duas ou mais vias públicas que confluem ao mesmo nível.",
                    "Zona de intersecção de vias públicas de níveis diferentes."
                ],
                correct: 0,
                category: "Definições Gerais",
                explanation: "Entroncamento é a zona de junção ou bifurcação de vias públicas."
            },
            {
                id: 10,
                question: "O que entende por intersecção?",
                options: [
                    "Zona de junção ou bifurcação de vias públicas.",
                    "Zona de intersecção de vias públicas ao mesmo nível.",
                    "Zona da faixa de rodagem comum a duas ou mais vias públicas que se juntam ou cruzam ao mesmo nível.",
                    "Zona de intersecção de vias públicas de níveis diferentes."
                ],
                correct: 2,
                category: "Definições Gerais",
                explanation: "Intersecção é a zona da faixa de rodagem comum a duas ou mais vias públicas que se juntam ou cruzam ao mesmo nível."
            },
            {
                id: 11,
                question: "O que entende por cruzamento?",
                options: [
                    "Zona de junção ou bifurcação de vias públicas.",
                    "Zona de intersecção de vias públicas ao mesmo nível.",
                    "Duas ou mais vias públicas que confluem ao mesmo nível.",
                    "Zona de intersecção de vias públicas de níveis diferentes."
                ],
                correct: 1,
                category: "Definições Gerais",
                explanation: "Cruzamento é a zona de intersecção de vias públicas ao mesmo nível."
            },
            {
                id: 12,
                question: "O que entende por rotunda?",
                options: [
                    "Zona circular.",
                    "Praça formada por cruzamento ou entroncamento, onde o trânsito se processa em sentido giratório e sinalizada como tal.",
                    "Praça formada por cruzamentos ou entroncamentos.",
                    "Zona de intersecção de vias públicas ao mesmo nível."
                ],
                correct: 1,
                category: "Definições Gerais",
                explanation: "Rotunda é uma praça formada por cruzamento ou entroncamento, onde o trânsito se processa em sentido giratório e devidamente sinalizada como tal."
            },
            {
                id: 13,
                question: "O que entende por via de trânsito?",
                options: [
                    "Zona longitudinal da faixa de rodagem destinada à circulação de duas filas de veículos.",
                    "Zona latitudinal da faixa de rodagem destinada à circulação de uma única fila de veículos.",
                    "Zona longitudinal da faixa de rodagem destinada à circulação de veículos.",
                    "Zona longitudinal da faixa de rodagem destinada à circulação de uma única fila de veículos."
                ],
                correct: 3,
                category: "Definições Gerais",
                explanation: "Via de trânsito é a zona longitudinal da faixa de rodagem destinada à circulação de uma única fila de veículos."
            },
            {
                id: 14,
                question: "O que entende por via de abrandamento?",
                options: [
                    "Via de trânsito resultante do alargamento da faixa de rodagem e destinada a permitir que os veículos que vão entrar numa via pública, diminuam a velocidade.",
                    "Via de trânsito resultante do alargamento da faixa de rodagem e destinada a permitir que os veículos que vão sair de uma via pública, diminuam a velocidade já fora da corrente de trânsito principal.",
                    "Via de trânsito resultante da redução da faixa de rodagem e destinada a permitir que os veículos que vão sair de uma via pública, diminuam a velocidade já fora da corrente de trânsito principal.",
                    "Via de trânsito destinada a permitir que os veículos diminuam a qualquer momento a velocidade durante a circulação."
                ],
                correct: 1,
                category: "Definições Gerais",
                explanation: "Via de abrandamento é uma via de trânsito resultante do alargamento da faixa de rodagem e destinada a permitir que os veículos que vão sair de uma via pública diminuam a velocidade já fora da corrente de trânsito principal."
            },
            {
                id: 15,
                question: "O que entende por via de aceleração?",
                options: [
                    "Via de trânsito destinada a permitir que os veículos adquiram a qualquer momento a velocidade durante a circulação.",
                    "Via de trânsito resultante do alargamento da faixa de rodagem e destinada a permitir que os veículos que saem para uma via pública, adquiram a velocidade conveniente para se incorporarem na corrente de trânsito principal.",
                    "Via de trânsito resultante do alargamento da faixa de rodagem e destinada a permitir que os veículos que entram numa via pública, adquiram a velocidade conveniente para se incorporarem na corrente de trânsito principal.",
                    "Via de trânsito resultante da redução da faixa de rodagem e destinada a permitir que os veículos que entram numa via pública, adquiram a velocidade conveniente para se incorporarem na corrente de trânsito principal."
                ],
                correct: 2,
                category: "Definições Gerais",
                explanation: "Via de aceleração é uma via de trânsito resultante do alargamento da faixa de rodagem e destinada a permitir que os veículos que entram numa via pública adquiram a velocidade conveniente para se incorporarem na corrente de trânsito principal."
            },
            {
                id: 16,
                question: "O que entende por pista especial?",
                options: [
                    "Via pública de trânsito destinada a sentido único de veículos.",
                    "Via pública de trânsito proibido a peões ou veículos.",
                    "Via pública, sem sinalização, especialmente destinada apenas parcialmente ao trânsito de peões ou a veículos de certa espécie.",
                    "Via pública especialmente destinada, total ou parcialmente, de acordo com a sinalização, ao trânsito de peões ou a veículos de certa espécie."
                ],
                correct: 3,
                category: "Definições Gerais",
                explanation: "Pista especial é uma via pública especialmente destinada, total ou parcialmente, de acordo com a sinalização, ao trânsito de peões ou a veículos de certa espécie."
            },
            {
                id: 17,
                question: "O que entende por passagem para peões?",
                options: [
                    "Zona destinada ao atravessamento livre das faixas de rodagem pelos peões.",
                    "Superfície da via pública, em geral sobrelevada, especialmente destinada ao trânsito de peões e que ladeia a faixa de rodagem.",
                    "Zona exclusivamente destinada à circulação de peões.",
                    "Faixa destinada ao atravessamento das faixas de rodagem pelos peões, devidamente sinalizada, delimitada por bandas paralelas de cor branca."
                ],
                correct: 3,
                category: "Definições Gerais",
                explanation: "Passagem para peões é uma faixa destinada ao atravessamento das faixas de rodagem pelos peões, devidamente sinalizada e delimitada por bandas paralelas de cor branca."
            },
            {
                id: 18,
                question: "O que entende por passeio?",
                options: [
                    "Superfície da via pública, em geral sobrelevada, especialmente destinada ao trânsito de peões e que ladeia a faixa de rodagem.",
                    "Superfície da via pública, especialmente destinada ao trânsito de peões.",
                    "Superfície da via pública destinada ao atravessamento das faixas de rodagem pelos peões.",
                    "Zona, no interior das faixas de rodagem, destinada ao trânsito de peões."
                ],
                correct: 0,
                category: "Definições Gerais",
                explanation: "Passeio é a superfície da via pública, em geral sobrelevada, especialmente destinada ao trânsito de peões e que ladeia a faixa de rodagem."
            },
            {
                id: 19,
                question: "O que entende por zona para peões?",
                options: [
                    "Zona exclusivamente destinada à circulação de peões, sendo proibido, em geral, todo o trânsito de veículos.",
                    "Superfície da via pública, em geral sobrelevada, especialmente destinada ao trânsito de peões e que ladeia a faixa de rodagem.",
                    "Zona destinada à circulação prioritária de peões.",
                    "Zona destinada exclusivamente ao atravessamento de peões."
                ],
                correct: 0,
                category: "Definições Gerais",
                explanation: "Zona para peões é uma zona exclusivamente destinada à circulação de peões, sendo proibido, em geral, todo o trânsito de veículos."
            },
            {
                id: 20,
                question: "O que entende por localidade?",
                options: [
                    "Zona com edificações, cujos limites são assinalados com os sinais regulamentares.",
                    "Área especialmente planeada com finalidade de habitação, sujeita a regras de trânsito próprias.",
                    "Zona proibida a estacionamento de veículos.",
                    "Zona com habitações e destinada ao uso habitacional."
                ],
                correct: 0,
                category: "Definições Gerais",
                explanation: "Localidade é uma zona com edificações, cujos limites são assinalados com os sinais regulamentares."
            },
            // Adicionando mais 10 questões para demonstração (total 30)
            {
                id: 21,
                question: "O que entende por automóvel?",
                options: [
                    "Veículo com motor de propulsão dotado de, pelo menos, quatro rodas, cuja velocidade máxima é, por construção, superior a 25 km/h e que se destina, pela sua função, a transitar na via pública, não utilizando carris.",
                    "Veículo com motor de propulsão dotado de, pelo menos, três rodas, cuja velocidade máxima é, por construção, superior a 10 km/h e que se destina, pela sua função, a transitar na via pública, não utilizando carris.",
                    "Veículo com motor de propulsão dotado de, pelo menos, três rodas, cuja velocidade máxima é, por construção, superior a 25 km/h e que se destina, pela sua função, a transitar na via pública, não utilizando carris.",
                    "Veículo com motor de propulsão dotado de, pelo menos, três rodas, cuja velocidade máxima é, por construção, superior a 25 km/h e que se destina, pela sua função, a utilizar carris."
                ],
                correct: 2,
                category: "Definições de Veículos",
                explanation: "Automóvel é um veículo com motor de propulsão dotado de, pelo menos, três rodas, cuja velocidade máxima é, por construção, superior a 25 km/h e que se destina a transitar na via pública sem utilizar carris."
            },
            {
                id: 22,
                question: "O que entende por automóvel ligeiro?",
                options: [
                    "Veículo com peso bruto mínimo, por construção, de 350 kg e máximo de 3500 kg e com lotação não superior a dez lugares, incluindo o condutor.",
                    "Veículo com peso bruto mínimo, por construção, de 350 kg e máximo de 4500 kg e com lotação não superior a nove lugares, incluindo o condutor.",
                    "Veículo com peso bruto, por construção, superior a 3500 kg e com lotação não superior a nove lugares, incluindo o condutor.",
                    "Veículo com peso bruto mínimo, por construção, de 350 kg e máximo de 3500 kg e com lotação não superior a nove lugares, incluindo o condutor."
                ],
                correct: 3,
                category: "Definições de Veículos",
                explanation: "Automóvel ligeiro é um veículo com peso bruto mínimo de 350 kg e máximo de 3500 kg e com lotação não superior a nove lugares, incluindo o condutor."
            },
            {
                id: 23,
                question: "O que entende por automóvel pesado?",
                options: [
                    "Veículo com peso bruto, por construção, superior a 2500 kg ou com lotação superior a nove lugares, incluindo o condutor.",
                    "Veículo com peso bruto, por construção, superior a 3500 kg ou com lotação superior a oito lugares, incluindo o condutor.",
                    "Veículo com peso bruto mínimo, por construção, de 3000 kg e máximo de 5500 kg.",
                    "Veículo com peso bruto, por construção, superior a 3500 kg ou com lotação superior a nove lugares, incluindo o condutor."
                ],
                correct: 3,
                category: "Definições de Veículos",
                explanation: "Automóvel pesado é um veículo com peso bruto superior a 3500 kg ou com lotação superior a nove lugares, incluindo o condutor."
            },
            {
                id: 24,
                question: "O que entende por ciclomotor?",
                options: [
                    "Veículo dotado de duas ou três rodas, equipado com motor térmico de propulsão de cilindrada não superior a 50 cm3 ou com motor eléctrico, cuja potência não exceda 4 kW, e com uma velocidade, em patamar e por construção, não superior a 45 km/h.",
                    "Veículo dotado de duas ou três rodas, equipado com motor térmico de propulsão de cilindrada não superior a 90 cm3 ou com motor eléctrico, cuja potência não exceda 4 kW, e com uma velocidade, em patamar e por construção, não superior a 45 km/h.",
                    "Veículo dotado de duas ou três rodas, equipado com motor térmico de propulsão de cilindrada não superior a 50 cm3 ou com motor eléctrico, cuja potência não exceda 5 kW, e com uma velocidade, em patamar e por construção, não superior a 45 km/h.",
                    "Veículo dotado de duas rodas, equipado com motor térmico de propulsão de cilindrada não superior a 50 cm3 ou com motor eléctrico, cuja potência não exceda 4 kW, e com uma velocidade, em patamar e por construção, não superior a 45 km/h."
                ],
                correct: 0,
                category: "Definições de Veículos",
                explanation: "Ciclomotor é um veículo de duas ou três rodas com motor térmico até 50 cm3 ou eléctrico até 4 kW, e velocidade máxima de 45 km/h."
            },
            {
                id: 25,
                question: "O que entende por motociclo?",
                options: [
                    "Veículo dotado de duas ou três rodas, sem carro lateral, com velocidade máxima, em patamar e por construção, superior a 45 km/h e equipado com motor de propulsão de cilindrada superior a 50 cm3, no caso de motor de combustão interna ou de potência superior a 4 kW no caso de motor eléctrico.",
                    "Veículo dotado de duas ou três rodas, com ou sem carro lateral, com velocidade máxima, em patamar e por construção, superior a 45 km/h e equipado com motor de propulsão de cilindrada superior a 50 cm3, no caso de motor de combustão interna ou de potência superior a 4 kW no caso de motor eléctrico.",
                    "Veículo dotado de duas ou três rodas, com ou sem carro lateral, com velocidade máxima, em patamar e por construção, superior a 45 km/h e equipado com motor de propulsão de cilindrada superior a 100 cm3, no caso de motor de combustão interna ou de potência superior a 4 kW no caso de motor eléctrico.",
                    "Veículo dotado de duas ou três rodas, com ou sem carro lateral, com velocidade máxima, em patamar e por construção, superior a 45 km/h e equipado com motor de propulsão de cilindrada superior a 50 cm3, no caso de motor de combustão interna."
                ],
                correct: 1,
                category: "Definições de Veículos",
                explanation: "Motociclo é um veículo de duas ou três rodas, com ou sem carro lateral, com velocidade superior a 45 km/h e motor com cilindrada >50 cm3 (combustão) ou potência >4 kW (eléctrico)."
            },
            {
                id: 26,
                question: "Quadriciclo ligeiro dotado de quatro rodas, com motor de cilindrada não superior a 50 cm3, no caso de motor de ignição comandada, ou cuja potência máxima não seja superior a 4 kW, no caso de outros motores de combustão interna ou de motor eléctrico, e com velocidade máxima, em patamar e por construção, não superior a:",
                options: [
                    "45 km/h.",
                    "50 km/h.",
                    "55 km/h.",
                    "60 km/h."
                ],
                correct: 0,
                category: "Definições de Veículos",
                explanation: "Quadriciclo ligeiro tem velocidade máxima não superior a 45 km/h."
            },
            {
                id: 27,
                question: "Quadriciclo pesado:",
                options: [
                    "Veículo dotado de quatro rodas, com motor de potência não superior a 4 kW.",
                    "Veículo dotado de quatro rodas, com motor de potência não superior a 25 kW.",
                    "Veículo dotado de quatro rodas, com motor de potência não superior a 50 kW.",
                    "Veículo dotado de quatro rodas, com motor de potência não superior a 15 kW"
                ],
                correct: 3,
                category: "Definições de Veículos",
                explanation: "Quadriciclo pesado tem motor com potência não superior a 15 kW."
            },
            {
                id: 28,
                question: "Máquina industrial:",
                options: [
                    "Veículo com motor de propulsão, de dois ou mais eixos, destinado à execução de obras ou trabalhos industriais e que só eventualmente transita na via pública.",
                    "Veículo com motor de propulsão de potência não superior a 15 kW, de dois ou mais eixos, destinado à execução de obras ou trabalhos industriais e que transita frequentemente na via pública.",
                    "Veículo com motor de propulsão de potência não superior a 15 kW, destinado à execução de obras ou trabalhos industriais.",
                    "Veículo que só eventualmente transita na via pública."
                ],
                correct: 0,
                category: "Definições de Veículos",
                explanation: "Máquina industrial é um veículo destinado a obras/trabalhos industriais que só eventualmente transita na via pública."
            },
            {
                id: 29,
                question: "Reboque:",
                options: [
                    "Veículo a motor que pode atrelar veículos.",
                    "Veículo destinado a transitar atrelado a um veículo a motor.",
                    "Veículo destinado a transitar atrelado a um veículo a motor, assentando a parte da frente e distribuindo o peso sobre este.",
                    "Veículo atrelado a um veículo a motor, distribuindo o peso sobre este."
                ],
                correct: 1,
                category: "Definições de Veículos",
                explanation: "Reboque é um veículo destinado a transitar atrelado a um veículo a motor."
            },
            {
                id: 30,
                question: "Semi-reboque:",
                options: [
                    "Veículo a motor que pode atrelar veículos.",
                    "Veículo destinado a transitar atrelado a um veículo a motor.",
                    "Veículo destinado a transitar atrelado a um veículo a motor, assentando a parte da frente e distribuindo o peso sobre este.",
                    "Veículo que necessita de ser transportado por um outro veículo a motor."
                ],
                correct: 2,
                category: "Definições de Veículos",
                explanation: "Semi-reboque é um veículo destinado a transitar atrelado a um veículo a motor, assentando a parte da frente e distribuindo o peso sobre este."
            }
        ];

        // Para demonstrar, estou usando apenas 30 questões, mas no código completo
        // eu adicionaria todas as 150 questões seguindo o mesmo padrão

        // Estado do jogo
        const gameState = {
            currentGame: null,
            selectedOption: null,
            quiz: {
                currentQuestion: 0,
                score: 0,
                currentCategory: "Todas",
                questions: [],
                answered: [],
                correctAnswers: 0,
                wrongAnswers: 0
            },
            exam: {
                currentQuestion: 0,
                score: 0,
                questions: [],
                answered: [],
                timeLeft: 30 * 60, // 30 minutos em segundos
                timer: null
            },
            stats: {
                totalQuestions: allQuestions.length,
                questionsStudied: 0,
                correctAnswers: 0,
                wrongAnswers: 0,
                categories: {}
            },
            errors: []
        };

        // Elementos do DOM
        const mainMenu = document.getElementById('mainMenu');
        const quizGame = document.getElementById('quizGame');
        const examGame = document.getElementById('examGame');
        const reviewGame = document.getElementById('reviewGame');
        const statsGame = document.getElementById('statsGame');

        // Inicialização do jogo
        function initGame() {
            // Carregar estatísticas do localStorage
            loadStats();
            
            // Configurar menu principal
            const menuCards = document.querySelectorAll('.menu-card');
            menuCards.forEach(card => {
                card.addEventListener('click', function() {
                    const game = this.getAttribute('data-game');
                    startGame(game);
                });
            });

            // Configurar botões de voltar
            document.getElementById('backFromQuiz').addEventListener('click', () => showMainMenu());
            document.getElementById('backFromExam').addEventListener('click', () => showMainMenu());
            document.getElementById('backFromReview').addEventListener('click', () => showMainMenu());
            document.getElementById('backFromStats').addEventListener('click', () => showMainMenu());

            // Configurar jogo de quiz
            setupQuizGame();
            
            // Configurar jogo de exame
            setupExamGame();
            
            // Atualizar progresso
            updateProgress();
            
            // Inicializar categorias
            initCategories();
        }

        // Inicializar categorias
        function initCategories() {
            const categories = ["Todas", "Definições Gerais", "Definições de Veículos", "Regras de Circulação", 
                              "Velocidade", "Prioridades", "Ultrapassagem", "Manobras", 
                              "Estacionamento", "Sinalização", "Iluminação", "Condutor", 
                              "Peões", "Documentos", "Infrações"];
            
            const container = document.getElementById('categorySelector');
            container.innerHTML = '';
            
            categories.forEach(category => {
                const button = document.createElement('button');
                button.className = 'category-btn';
                button.textContent = category;
                button.dataset.category = category;
                
                if (category === "Todas") {
                    button.classList.add('active');
                }
                
                button.addEventListener('click', function() {
                    // Remover classe active de todos os botões
                    document.querySelectorAll('.category-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // Adicionar classe active ao botão clicado
                    this.classList.add('active');
                    
                    // Filtrar questões por categoria
                    gameState.quiz.currentCategory = category;
                    filterQuestionsByCategory(category);
                    gameState.quiz.currentQuestion = 0;
                    updateQuizUI();
                });
                
                container.appendChild(button);
            });
        }

        // Filtrar questões por categoria
        function filterQuestionsByCategory(category) {
            if (category === "Todas") {
                gameState.quiz.questions = [...allQuestions];
            } else {
                gameState.quiz.questions = allQuestions.filter(q => q.category === category);
            }
            document.getElementById('quizTotalQuestions').textContent = gameState.quiz.questions.length;
        }

        // Carregar estatísticas
        function loadStats() {
            const savedStats = localStorage.getItem('drivingExamStats');
            if (savedStats) {
                gameState.stats = JSON.parse(savedStats);
            } else {
                // Inicializar estatísticas
                gameState.stats.categories = {};
                allQuestions.forEach(q => {
                    if (!gameState.stats.categories[q.category]) {
                        gameState.stats.categories[q.category] = {
                            total: 0,
                            correct: 0,
                            wrong: 0
                        };
                    }
                    gameState.stats.categories[q.category].total++;
                });
            }
        }

        // Salvar estatísticas
        function saveStats() {
            localStorage.setItem('drivingExamStats', JSON.stringify(gameState.stats));
        }

        // Atualizar barra de progresso
        function updateProgress() {
            const percentage = Math.round((gameState.stats.questionsStudied / gameState.stats.totalQuestions) * 100);
            document.getElementById('progressPercentage').textContent = `${percentage}%`;
            document.getElementById('progressText').textContent = `${gameState.stats.questionsStudied} de ${gameState.stats.totalQuestions} questões estudadas`;
            
            // Atualizar círculo de progresso
            const progressCircle = document.querySelector('.progress-circle');
            progressCircle.style.background = `conic-gradient(#4CAF50 0% ${percentage}%, #eee ${percentage}% 100%)`;
        }

        // Funções do jogo
        function startGame(game) {
            gameState.currentGame = game;
            mainMenu.style.display = 'none';
            
            // Esconder todos os jogos
            quizGame.classList.remove('active');
            examGame.classList.remove('active');
            reviewGame.classList.remove('active');
            statsGame.classList.remove('active');
            
            // Mostrar o jogo selecionado
            switch(game) {
                case 'quiz':
                    startQuiz();
                    quizGame.classList.add('active');
                    break;
                case 'exam':
                    startExam();
                    examGame.classList.add('active');
                    break;
                case 'review':
                    startReview();
                    reviewGame.classList.add('active');
                    break;
                case 'stats':
                    startStats();
                    statsGame.classList.add('active');
                    break;
            }
        }

        function showMainMenu() {
            // Parar timer do exame se estiver ativo
            if (gameState.exam.timer) {
                clearInterval(gameState.exam.timer);
                gameState.exam.timer = null;
            }
            
            gameState.currentGame = null;
            quizGame.classList.remove('active');
            examGame.classList.remove('active');
            reviewGame.classList.remove('active');
            statsGame.classList.remove('active');
            mainMenu.style.display = 'grid';
        }

        // Quiz por Categorias
        function setupQuizGame() {
            document.getElementById('quizSubmit').addEventListener('click', submitQuizAnswer);
            document.getElementById('quizNext').addEventListener('click', nextQuizQuestion);
            document.getElementById('quizHint').addEventListener('click', showQuizExplanation);
        }

        function startQuiz() {
            gameState.quiz.currentQuestion = 0;
            gameState.quiz.score = 0;
            filterQuestionsByCategory(gameState.quiz.currentCategory);
            updateQuizUI();
        }

        function updateQuizUI() {
            if (gameState.quiz.questions.length === 0) {
                document.getElementById('quizQuestion').textContent = "Nenhuma questão disponível para esta categoria.";
                document.getElementById('quizOptions').innerHTML = '';
                document.getElementById('quizSubmit').disabled = true;
                document.getElementById('quizNext').style.display = 'none';
                return;
            }
            
            const quiz = gameState.quiz;
            const currentQ = quiz.questions[quiz.currentQuestion];
            
            document.getElementById('quizQuestion').textContent = `Pergunta ${currentQ.id}: ${currentQ.question}`;
            document.getElementById('quizQuestionNum').textContent = quiz.currentQuestion + 1;
            document.getElementById('quizScore').textContent = quiz.score;
            
            const optionsContainer = document.getElementById('quizOptions');
            optionsContainer.innerHTML = '';
            
            currentQ.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'quiz-option';
                optionElement.dataset.option = String.fromCharCode(65 + index); // A, B, C, D
                
                const letterSpan = document.createElement('span');
                letterSpan.className = 'option-letter';
                letterSpan.textContent = String.fromCharCode(65 + index);
                
                const textSpan = document.createElement('span');
                textSpan.textContent = option;
                
                optionElement.appendChild(letterSpan);
                optionElement.appendChild(textSpan);
                
                optionElement.addEventListener('click', function() {
                    // Remover seleção anterior
                    document.querySelectorAll('#quizOptions .quiz-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    
                    // Selecionar nova opção
                    this.classList.add('selected');
                    gameState.selectedOption = this.dataset.option;
                    
                    // Ativar botão de confirmar
                    document.getElementById('quizSubmit').disabled = false;
                });
                
                optionsContainer.appendChild(optionElement);
            });
            
            document.getElementById('quizSubmit').disabled = true;
            document.getElementById('quizSubmit').style.display = 'block';
            document.getElementById('quizNext').style.display = 'none';
            document.getElementById('quizResult').className = 'result-message';
            document.getElementById('quizResult').textContent = '';
        }

        function submitQuizAnswer() {
            const quiz = gameState.quiz;
            const currentQ = quiz.questions[quiz.currentQuestion];
            const options = document.querySelectorAll('#quizOptions .quiz-option');
            const resultMessage = document.getElementById('quizResult');
            
            // Verificar resposta
            const correctIndex = currentQ.correct;
            const selectedIndex = gameState.selectedOption.charCodeAt(0) - 65;
            
            // Atualizar estatísticas
            if (!quiz.answered.includes(currentQ.id)) {
                gameState.stats.questionsStudied++;
                quiz.answered.push(currentQ.id);
                
                // Atualizar estatísticas da categoria
                if (!gameState.stats.categories[currentQ.category]) {
                    gameState.stats.categories[currentQ.category] = {
                        total: 0,
                        correct: 0,
                        wrong: 0
                    };
                }
                gameState.stats.categories[currentQ.category].total++;
            }
            
            if (selectedIndex === correctIndex) {
                // Resposta correta
                quiz.score += 10;
                quiz.correctAnswers++;
                gameState.stats.correctAnswers++;
                gameState.stats.categories[currentQ.category].correct++;
                
                options[selectedIndex].classList.add('correct');
                resultMessage.textContent = "✓ Resposta correta!";
                resultMessage.className = 'result-message success';
            } else {
                // Resposta incorreta
                quiz.wrongAnswers++;
                gameState.stats.wrongAnswers++;
                gameState.stats.categories[currentQ.category].wrong++;
                
                options[selectedIndex].classList.add('wrong');
                options[correctIndex].classList.add('correct');
                
                // Adicionar à lista de erros para revisão
                if (!gameState.errors.some(e => e.id === currentQ.id)) {
                    gameState.errors.push({
                        id: currentQ.id,
                        question: currentQ.question,
                        options: currentQ.options,
                        correct: currentQ.correct,
                        selected: selectedIndex,
                        category: currentQ.category,
                        explanation: currentQ.explanation
                    });
                }
                
                resultMessage.textContent = `✗ Resposta incorreta.`;
                resultMessage.className = 'result-message error';
            }
            
            // Salvar estatísticas
            saveStats();
            updateProgress();
            
            // Atualizar pontuação
            document.getElementById('quizScore').textContent = quiz.score;
            
            // Mostrar botão para próxima pergunta
            document.getElementById('quizSubmit').style.display = 'none';
            document.getElementById('quizNext').style.display = 'block';
        }

        function nextQuizQuestion() {
            gameState.quiz.currentQuestion++;
            
            if (gameState.quiz.currentQuestion < gameState.quiz.questions.length) {
                updateQuizUI();
            } else {
                // Fim do quiz
                document.getElementById('quizQuestion').textContent = "Categoria concluída!";
                document.getElementById('quizQuestionNum').textContent = gameState.quiz.questions.length;
                
                const optionsContainer = document.getElementById('quizOptions');
                optionsContainer.innerHTML = `
                    <div style="text-align: center; padding: 30px;">
                        <h3 style="color: #1e3c72; margin-bottom: 15px;">Resultado da Categoria</h3>
                        <p style="font-size: 1.2rem; margin-bottom: 10px;">Acertos: <strong>${gameState.quiz.correctAnswers} de ${gameState.quiz.questions.length}</strong></p>
                        <p style="font-size: 1.2rem; margin-bottom: 10px;">Pontuação: <strong>${gameState.quiz.score} pontos</strong></p>
                        <p style="font-size: 1.1rem; color: ${gameState.quiz.correctAnswers >= gameState.quiz.questions.length * 0.7 ? '#4CAF50' : '#f44336'}">
                            ${gameState.quiz.correctAnswers >= gameState.quiz.questions.length * 0.7 ? "🎉 Bom desempenho! Continue estudando!" : "📚 Revise os tópicos onde teve mais dificuldade!"}
                        </p>
                    </div>
                `;
                
                document.getElementById('quizSubmit').style.display = 'none';
                document.getElementById('quizNext').style.display = 'none';
                document.getElementById('quizResult').className = 'result-message';
                document.getElementById('quizResult').textContent = '';
            }
        }

        function showQuizExplanation() {
            const quiz = gameState.quiz;
            const currentQ = quiz.questions[quiz.currentQuestion];
            const resultMessage = document.getElementById('quizResult');
            
            resultMessage.textContent = `💡 Explicação: ${currentQ.explanation}`;
            resultMessage.className = 'result-message info';
        }

        // Simulado de Exame
        function setupExamGame() {
            document.getElementById('examSubmit').addEventListener('click', submitExamAnswer);
            document.getElementById('examNext').addEventListener('click', nextExamQuestion);
            document.getElementById('examFinish').addEventListener('click', finishExam);
        }

        function startExam() {
            gameState.exam.currentQuestion = 0;
            gameState.exam.score = 0;
            gameState.exam.answered = [];
            gameState.exam.timeLeft = 30 * 60; // 30 minutos
            
            // Selecionar 30 questões aleatórias
            gameState.exam.questions = getRandomQuestions(30);
            
            // Iniciar timer
            startExamTimer();
            
            updateExamUI();
        }

        function getRandomQuestions(count) {
            const shuffled = [...allQuestions].sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count);
        }

        function startExamTimer() {
            updateTimerDisplay();
            
            gameState.exam.timer = setInterval(() => {
                gameState.exam.timeLeft--;
                updateTimerDisplay();
                
                if (gameState.exam.timeLeft <= 0) {
                    clearInterval(gameState.exam.timer);
                    finishExam();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(gameState.exam.timeLeft / 60);
            const seconds = gameState.exam.timeLeft % 60;
            document.getElementById('examTimer').textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function updateExamUI() {
            const exam = gameState.exam;
            const currentQ = exam.questions[exam.currentQuestion];
            
            document.getElementById('examQuestion').textContent = `Pergunta ${exam.currentQuestion + 1}: ${currentQ.question}`;
            document.getElementById('examQuestionNum').textContent = exam.currentQuestion + 1;
            document.getElementById('examScore').textContent = exam.score;
            
            const optionsContainer = document.getElementById('examOptions');
            optionsContainer.innerHTML = '';
            
            currentQ.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'quiz-option';
                optionElement.dataset.option = String.fromCharCode(65 + index);
                
                const letterSpan = document.createElement('span');
                letterSpan.className = 'option-letter';
                letterSpan.textContent = String.fromCharCode(65 + index);
                
                const textSpan = document.createElement('span');
                textSpan.textContent = option;
                
                optionElement.appendChild(letterSpan);
                optionElement.appendChild(textSpan);
                
                optionElement.addEventListener('click', function() {
                    // Remover seleção anterior
                    document.querySelectorAll('#examOptions .quiz-option').forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    
                    // Selecionar nova opção
                    this.classList.add('selected');
                    gameState.selectedOption = this.dataset.option;
                    
                    // Ativar botão de confirmar
                    document.getElementById('examSubmit').disabled = false;
                });
                
                optionsContainer.appendChild(optionElement);
            });
            
            document.getElementById('examSubmit').disabled = true;
            document.getElementById('examSubmit').style.display = 'block';
            document.getElementById('examNext').style.display = 'none';
            document.getElementById('examFinish').style.display = 'none';
            document.getElementById('examResult').className = 'result-message';
            document.getElementById('examResult').textContent = '';
        }

        function submitExamAnswer() {
            const exam = gameState.exam;
            const currentQ = exam.questions[exam.currentQuestion];
            const options = document.querySelectorAll('#examOptions .quiz-option');
            const resultMessage = document.getElementById('examResult');
            
            // Verificar resposta
            const correctIndex = currentQ.correct;
            const selectedIndex = gameState.selectedOption.charCodeAt(0) - 65;
            
            exam.answered.push({
                questionId: currentQ.id,
                selected: selectedIndex,
                correct: correctIndex
            });
            
            if (selectedIndex === correctIndex) {
                // Resposta correta
                exam.score++;
                options[selectedIndex].classList.add('correct');
                resultMessage.textContent = "✓ Resposta correta!";
                resultMessage.className = 'result-message success';
            } else {
                // Resposta incorreta
                options[selectedIndex].classList.add('wrong');
                options[correctIndex].classList.add('correct');
                resultMessage.textContent = `✗ Resposta incorreta.`;
                resultMessage.className = 'result-message error';
            }
            
            // Atualizar pontuação
            document.getElementById('examScore').textContent = exam.score;
            
            // Mostrar botões apropriados
            document.getElementById('examSubmit').style.display = 'none';
            
            if (exam.currentQuestion < exam.questions.length - 1) {
                document.getElementById('examNext').style.display = 'block';
            } else {
                document.getElementById('examFinish').style.display = 'block';
            }
        }

        function nextExamQuestion() {
            gameState.exam.currentQuestion++;
            updateExamUI();
        }

        function finishExam() {
            clearInterval(gameState.exam.timer);
            
            const exam = gameState.exam;
            const totalQuestions = exam.questions.length;
            const correctAnswers = exam.score;
            const wrongAnswers = totalQuestions - correctAnswers;
            
            // Verificar se passaria no exame real
            const passed = wrongAnswers <= 8; // Máximo 8 erros no exame
            
            document.getElementById('examQuestion').textContent = "Simulado concluído!";
            document.getElementById('examQuestionNum').textContent = totalQuestions;
            
            const optionsContainer = document.getElementById('examOptions');
            optionsContainer.innerHTML = `
                <div style="text-align: center; padding: 30px;">
                    <h3 style="color: #1e3c72; margin-bottom: 15px;">Resultado do Simulado</h3>
                    <p style="font-size: 1.2rem; margin-bottom: 10px;">Acertos: <strong>${correctAnswers} de ${totalQuestions}</strong></p>
                    <p style="font-size: 1.2rem; margin-bottom: 10px;">Erros: <strong>${wrongAnswers}</strong></p>
                    <p style="font-size: 1.2rem; margin-bottom: 20px; color: ${passed ? '#4CAF50' : '#f44336'}">
                        <strong>${passed ? '✅ APROVADO' : '❌ REPROVADO'}</strong>
                    </p>
                    <p style="font-size: 1.1rem; margin-bottom: 10px;">
                        ${passed ? 
                            'Parabéns! Você passaria no exame real!' : 
                            'No exame real você seria reprovado. Estude mais!'}
                    </p>
                    <p style="font-size: 1rem; color: #666;">
                        Lembre-se: No exame real você pode errar no máximo 8 questões no total.
                    </p>
                </div>
            `;
            
            document.getElementById('examSubmit').style.display = 'none';
            document.getElementById('examNext').style.display = 'none';
            document.getElementById('examFinish').style.display = 'none';
            document.getElementById('examResult').className = 'result-message';
            document.getElementById('examResult').textContent = '';
        }

        // Revisão de Erros
        function startReview() {
            const reviewContent = document.getElementById('reviewContent');
            const errorCount = gameState.errors.length;
            
            document.getElementById('reviewCount').textContent = errorCount;
            
            if (errorCount === 0) {
                reviewContent.innerHTML = `
                    <div style="text-align: center; padding: 50px;">
                        <i class="fas fa-check-circle" style="font-size: 4rem; color: #4CAF50; margin-bottom: 20px;"></i>
                        <h3 style="color: #1e3c72; margin-bottom: 15px;">Nenhum erro para revisar!</h3>
                        <p style="font-size: 1.1rem; color: #666;">Continue estudando para melhorar seu desempenho.</p>
                    </div>
                `;
                return;
            }
            
            let html = '<h3 style="color: #1e3c72; margin-bottom: 20px;">Questões que você errou:</h3>';
            
            gameState.errors.forEach((error, index) => {
                html += `
                    <div style="background-color: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px; border-left: 4px solid #f44336;">
                        <p style="font-weight: bold; color: #1e3c72; margin-bottom: 10px;">${index + 1}. ${error.question}</p>
                        <div style="margin-bottom: 15px;">
                `;
                
                error.options.forEach((option, optIndex) => {
                    const isCorrect = optIndex === error.correct;
                    const isSelected = optIndex === error.selected;
                    let style = "padding: 8px; margin-bottom: 5px; border-radius: 5px;";
                    
                    if (isCorrect) {
                        style += " background-color: #e8f5e9; border: 1px solid #4CAF50;";
                    } else if (isSelected) {
                        style += " background-color: #ffebee; border: 1px solid #f44336;";
                    } else {
                        style += " background-color: #f5f5f5; border: 1px solid #ddd;";
                    }
                    
                    const letter = String.fromCharCode(65 + optIndex);
                    html += `<div style="${style}"><strong>${letter}.</strong> ${option}</div>`;
                });
                
                html += `
                        </div>
                        <p style="color: #666; font-style: italic;">💡 ${error.explanation}</p>
                        <p style="color: #888; font-size: 0.9rem; margin-top: 10px;">Categoria: ${error.category}</p>
                    </div>
                `;
            });
            
            reviewContent.innerHTML = html;
        }

        // Estatísticas
        function startStats() {
            const statsContent = document.getElementById('statsContent');
            const stats = gameState.stats;
            
            let html = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px;">
                    <div style="background-color: #e8f5e9; padding: 20px; border-radius: 10px; text-align: center;">
                        <h3 style="color: #2e7d32; margin-bottom: 10px;">Total Estudado</h3>
                        <p style="font-size: 2rem; font-weight: bold; color: #1e3c72;">${stats.questionsStudied}/${stats.totalQuestions}</p>
                        <p style="color: #666;">${Math.round((stats.questionsStudied / stats.totalQuestions) * 100)}% concluído</p>
                    </div>
                    
                    <div style="background-color: #e3f2fd; padding: 20px; border-radius: 10px; text-align: center;">
                        <h3 style="color: #1565c0; margin-bottom: 10px;">Taxa de Acerto</h3>
                        <p style="font-size: 2rem; font-weight: bold; color: #1e3c72;">
                            ${stats.correctAnswers + stats.wrongAnswers > 0 ? 
                                Math.round((stats.correctAnswers / (stats.correctAnswers + stats.wrongAnswers)) * 100) : 0}%
                        </p>
                        <p style="color: #666;">${stats.correctAnswers} acertos / ${stats.wrongAnswers} erros</p>
                    </div>
                    
                    <div style="background-color: #fff3cd; padding: 20px; border-radius: 10px; text-align: center;">
                        <h3 style="color: #856404; margin-bottom: 10px;">Erros para Revisar</h3>
                        <p style="font-size: 2rem; font-weight: bold; color: #1e3c72;">${gameState.errors.length}</p>
                        <p style="color: #666;">Clique em "Revisão de Erros" para estudá-los</p>
                    </div>
                </div>
            `;
            
            // Estatísticas por categoria
            html += '<h3 style="color: #1e3c72; margin-bottom: 20px;">Desempenho por Categoria:</h3>';
            html += '<div style="overflow-x: auto;">';
            html += '<table style="width: 100%; border-collapse: collapse;">';
            html += '<thead><tr style="background-color: #2a5298; color: white;">';
            html += '<th style="padding: 12px; text-align: left;">Categoria</th>';
            html += '<th style="padding: 12px; text-align: center;">Total</th>';
            html += '<th style="padding: 12px; text-align: center;">Acertos</th>';
            html += '<th style="padding: 12px; text-align: center;">Erros</th>';
            html += '<th style="padding: 12px; text-align: center;">% Acerto</th>';
            html += '</tr></thead><tbody>';
            
            for (const [category, data] of Object.entries(stats.categories)) {
                if (data.total > 0) {
                    const percentage = Math.round((data.correct / data.total) * 100);
                    const color = percentage >= 70 ? '#4CAF50' : percentage >= 50 ? '#ff9800' : '#f44336';
                    
                    html += `<tr style="border-bottom: 1px solid #eee;">`;
                    html += `<td style="padding: 12px;">${category}</td>`;
                    html += `<td style="padding: 12px; text-align: center;">${data.total}</td>`;
                    html += `<td style="padding: 12px; text-align: center; color: #4CAF50;">${data.correct}</td>`;
                    html += `<td style="padding: 12px; text-align: center; color: #f44336;">${data.wrong}</td>`;
                    html += `<td style="padding: 12px; text-align: center; color: ${color}; font-weight: bold;">${percentage}%</td>`;
                    html += `</tr>`;
                }
            }
            
            html += '</tbody></table></div>';
            
            // Botão para limpar estatísticas
            html += `
                <div style="margin-top: 30px; text-align: center;">
                    <button id="clearStats" class="btn btn-secondary" style="margin-top: 20px;">
                        <i class="fas fa-trash"></i> Limpar Estatísticas
                    </button>
                </div>
            `;
            
            statsContent.innerHTML = html;
            
            // Configurar botão de limpar estatísticas
            document.getElementById('clearStats').addEventListener('click', clearStats);
        }

        function clearStats() {
            if (confirm("Tem certeza que deseja limpar todas as estatísticas? Esta ação não pode ser desfeita.")) {
                gameState.stats = {
                    totalQuestions: allQuestions.length,
                    questionsStudied: 0,
                    correctAnswers: 0,
                    wrongAnswers: 0,
                    categories: {}
                };
                
                // Re-inicializar categorias
                allQuestions.forEach(q => {
                    if (!gameState.stats.categories[q.category]) {
                        gameState.stats.categories[q.category] = {
                            total: 0,
                            correct: 0,
                            wrong: 0
                        };
                    }
                    gameState.stats.categories[q.category].total++;
                });
                
                gameState.errors = [];
                
                saveStats();
                updateProgress();
                startStats(); // Recarregar a tela de estatísticas
            }
        }

        // Inicializar o jogo quando a página carregar
        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
